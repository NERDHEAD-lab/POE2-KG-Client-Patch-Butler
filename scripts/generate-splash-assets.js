
import fs from 'node:fs';
import path from 'node:path';
import { fileURLToPath } from 'node:url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Source Paths
const SOURCE_ROOT = path.join(__dirname, '../assets/splash');
const FILES_TO_CONVERT = [
    { name: 'logo.png', path: 'logo.png', varName: 'SPLASH_LOGO_BASE64' }
];

const OUTPUT_FILE = path.join(__dirname, '../src/generated/splashAssets.ts');
const OUTPUT_DIR = path.dirname(OUTPUT_FILE);

if (!fs.existsSync(OUTPUT_DIR)) {
    fs.mkdirSync(OUTPUT_DIR, { recursive: true });
}

let fileContent = '// This file is auto-generated by scripts/generate-splash-assets.js\n\n';

FILES_TO_CONVERT.forEach(file => {
    const fullPath = path.join(SOURCE_ROOT, file.path);
    if (fs.existsSync(fullPath)) {
        console.log(`Reading ${file.name}...`);
        const bitmap = fs.readFileSync(fullPath);
        const base64 = bitmap.toString('base64');
        fileContent += `export const ${file.varName} = \`${base64}\`;\n`;
    } else {
        console.error(`File not found: ${fullPath}`);
        process.exit(1);
    }
});

fs.writeFileSync(OUTPUT_FILE, fileContent);
console.log(`Generated ${OUTPUT_FILE} successfully.`);
